<!-- PAGE BACKDROP -->
<div class="min-h-screen px-6 py-10
            bg-gradient-to-br from-indigo-900 via-purple-900 to-fuchsia-900">

  <!-- HEADER -->
  <div class="max-w-6xl mx-auto mb-10
              bg-white/10 backdrop-blur-xl
              border border-white/20
              rounded-3xl p-8 shadow-2xl">

    <h1 class="text-3xl font-extrabold text-white">
      Attendance Reports
    </h1>
    <p class="mt-2 text-white/70">
      Analyze your attendance performance
    </p>
  </div>

  <!-- LOADING -->
  <div *ngIf="loading" class="text-center py-20 text-white">
    Loading reportsâ€¦
  </div>

  <!-- OVERALL SUMMARY -->
  <div *ngIf="!loading && overall"
       class="max-w-6xl mx-auto mb-12
              bg-white/10 backdrop-blur-xl
              border border-white/20
              rounded-3xl p-10 text-center shadow-2xl">

    <div
      class="text-7xl font-extrabold"
      [ngClass]="{
        'text-emerald-400': overall.percentage >= 75,
        'text-amber-400': overall.percentage >= 60 && overall.percentage < 75,
        'text-rose-400': overall.percentage < 60
      }">
      {{ overall.percentage }}%
    </div>

    <p class="mt-4 text-white/80 text-lg">
      {{ overall.attended }} / {{ overall.total }} classes attended
    </p>
  </div>

  <!-- EXPORT -->
  <div class="max-w-6xl mx-auto mb-10 flex justify-end">
    <button
      mat-raised-button
      class="bg-white text-gray-900 font-semibold shadow-lg"
      (click)="exportCSV()">
      <mat-icon>download</mat-icon>
      Export CSV
    </button>
  </div>

  <!-- SUBJECT TABLE -->
  <div *ngIf="!loading"
       class="max-w-6xl mx-auto
              bg-white/10 backdrop-blur-xl
              border border-white/20
              rounded-3xl p-8 shadow-2xl">

    <table class="w-full text-white">
      <thead>
        <tr class="border-b border-white/20 text-left">
          <th class="py-4">Subject</th>
          <th>Attendance</th>
          <th>Status</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let s of subjectStats"
            class="border-b border-white/10 hover:bg-white/5 transition">

          <td class="py-4">
            <div class="font-semibold">{{ s.subject.name }}</div>
            <div class="text-sm text-white/60">{{ s.subject.code }}</div>
          </td>

          <td>
            {{ s.percentage }}% ({{ s.attended }}/{{ s.total }})
          </td>

          <td>
            <span
              class="px-4 py-1 rounded-full text-sm font-semibold"
              [ngClass]="{
                'bg-emerald-500/20 text-emerald-300': s.percentage >= 75,
                'bg-amber-500/20 text-amber-300': s.percentage >= 60 && s.percentage < 75,
                'bg-rose-500/20 text-rose-300': s.percentage < 60
              }">
              {{ s.percentage >= 75 ? 'Good' :
                 s.percentage >= 60 ? 'Average' : 'Low' }}
            </span>
          </td>

        </tr>
      </tbody>
    </table>

    <p *ngIf="subjectStats.length === 0"
       class="text-center py-12 text-white/70">
      No subject data available
    </p>

  </div>
</div>
